<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¾®å…‰æ—¥å¸¸</title>

    <!-- PWA èº«åˆ†è­‰æ¨™ç±¤ -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="å¾®å…‰æ—¥å¸¸">
    
    <!-- ğŸ‘‡ è®“ç€è¦½å™¨ä¸Šæ–¹çš„åˆ†é ä¹Ÿé¡¯ç¤ºå°åœ–ç¤º -->
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">

    <!-- 1. å¼•å…¥ Tailwind CSS (è² è²¬æ’ç‰ˆèˆ‡é¡è‰²) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 2. å¼•å…¥ React æ ¸å¿ƒå‡½å¼åº« -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

    <!-- 3. å¼•å…¥ Babel (è®“ç€è¦½å™¨èƒ½ç›´æ¥çœ‹æ‡‚ React èªæ³•) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- å‹•ç•«èˆ‡å…¨åŸŸæ¨£å¼è¨­å®š -->
    <style>
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(-250px) scale(0.5); opacity: 0; }
        }
        @keyframes pulseStar {
            0% { transform: scale(0.8); opacity: 0.6; }
            100% { transform: scale(1.2); opacity: 1; box-shadow: 0 0 15px 5px rgba(255, 253, 231, 0.8); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* éš±è—æ²è»¸ä½†ä¿æŒå¯æ»‘å‹•ï¼Œå¢æ·» App æ²‰æµ¸æ„Ÿ */
        ::-webkit-scrollbar {
            display: none;
        }
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background-color: #FDFBF7; /* é è¨­èƒŒæ™¯é˜²é–ƒçˆ */
        }
    </style>
</head>
<body>
    <!-- React æ‡‰ç”¨ç¨‹å¼æœƒè¢«æ¸²æŸ“åœ¨é€™å€‹ div è£¡é¢ -->
    <div id="root"></div>

    <!-- é€™è£¡å°±æ˜¯ä½ çš„ React ç¨‹å¼ç¢¼è¢«åŒ…è£åœ¨ script æ¨™ç±¤è£¡ -->
    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [step, setStep] = useState('input');
            const [isNightMode, setIsNightMode] = useState(false);
            const [inputs, setInputs] = useState({ t1: '', t2: '', t3: '' });
            const [history, setHistory] = useState([]);
            const [animatingStars, setAnimatingStars] = useState([]);
            const [selectedMemory, setSelectedMemory] = useState(null);

            const handleSubmit = () => {
                setStep('animating');
                setIsNightMode(true);

                const newStars = [
                    { id: 1, left: 30, delay: Math.random() * 0.5 },
                    { id: 2, left: 50, delay: Math.random() * 0.5 },
                    { id: 3, left: 70, delay: Math.random() * 0.5 },
                ];
                setAnimatingStars(newStars);

                setTimeout(() => {
                    const newEntry = {
                        id: Date.now(),
                        date: "å‰›å‰›",
                        entries: [
                            inputs.t1 || 'ç•™ç™½çš„ä¸€å¤©',
                            inputs.t2 || 'å®‰éœåœ°åº¦é',
                            inputs.t3 || 'æ„Ÿè¬è‡ªå·±é‚„åœ¨å‘¼å¸'
                        ],
                        x: 10 + Math.random() * 80,
                        y: 10 + Math.random() * 80,
                        pulseDuration: 1.5 + Math.random() * 2.5
                    };
                    
                    setHistory(prev => [...prev, newEntry]);
                    setStep('success');
                    setAnimatingStars([]);
                    setInputs({ t1: '', t2: '', t3: '' });
                }, 2500);
            };

            return (
                <div className={`min-h-screen w-full transition-colors duration-[2000ms] ease-in-out font-sans overflow-x-hidden ${isNightMode ? 'bg-[#1c2128] text-[#E0E0E0]' : 'bg-[#FDFBF7] text-[#5A5A5A]'}`}>
                    <div className="max-w-md mx-auto px-5 pt-10 pb-16 relative min-h-screen flex flex-col">
                        
                        {/* ç•«é¢ä¸€ï¼šè¼¸å…¥å€ */}
                        <div className={`transition-opacity duration-1000 ${step === 'input' ? 'opacity-100' : 'opacity-0 pointer-events-none absolute'}`}>
                            <div className="text-[18px] mb-8 leading-relaxed">
                                æ­¡è¿ã€‚<br/>
                                <img src="https://fonts.gstatic.com/s/e/notoemoji/latest/1f4a1/512.gif" alt="å¾®å…‰" className="w-6 h-6 my-1 inline-block" /><br/>
                                ä¸éœ€è¦å®Œç¾çš„è¨ˆç•«ï¼Œ<br/>
                                æˆ‘å€‘åªæ”¶é›†ä½ ä»Šå¤©åº¦éçš„ä¸€çµ²å¾®å…‰ã€‚
                            </div>

                            <div className="space-y-6">
                                <div>
                                    <label className="block text-[15px] font-medium mb-2 opacity-80">ä»Šå¤©ï¼Œæœ‰ä»€éº¼å¾®å°çš„äº‹ç‰©è®“ä½ æ„Ÿè¦ºé‚„ä¸éŒ¯ï¼Ÿ</label>
                                    <textarea rows="2" value={inputs.t1} onChange={(e) => setInputs({...inputs, t1: e.target.value})} className="w-full bg-[#F4F1EA] text-[#4A4A4A] rounded-2xl p-4 text-[16px] resize-none outline-none focus:bg-[#EBE6DC] transition-colors" placeholder="è¼•è¼•å¯«ä¸‹ä¸€å¥è©±..."></textarea>
                                </div>
                                <div>
                                    <label className="block text-[15px] font-medium mb-2 opacity-80">ä»Šå¤©ï¼Œä½ ç‚ºè‡ªå·±åšäº†ä¸€ä»¶ä»€éº¼å°äº‹ï¼Ÿ</label>
                                    <textarea rows="2" value={inputs.t2} onChange={(e) => setInputs({...inputs, t2: e.target.value})} className="w-full bg-[#F4F1EA] text-[#4A4A4A] rounded-2xl p-4 text-[16px] resize-none outline-none focus:bg-[#EBE6DC] transition-colors" placeholder="è¼•è¼•å¯«ä¸‹ä¸€å¥è©±..."></textarea>
                                </div>
                                <div>
                                    <label className="block text-[15px] font-medium mb-2 opacity-80">ä»Šå¤©ï¼Œå°±ç®—æœ‰ä¸å¦‚æ„ï¼Œä½ æƒ³æ„Ÿè¬è‡ªå·±ä»€éº¼ï¼Ÿ</label>
                                    <textarea rows="2" value={inputs.t3} onChange={(e) => setInputs({...inputs, t3: e.target.value})} className="w-full bg-[#F4F1EA] text-[#4A4A4A] rounded-2xl p-4 text-[16px] resize-none outline-none focus:bg-[#EBE6DC] transition-colors" placeholder="è¼•è¼•å¯«ä¸‹ä¸€å¥è©±..."></textarea>
                                </div>
                            </div>

                            <button onClick={handleSubmit} className="w-full bg-[#8C9C8C] text-white py-4 rounded-full text-[16px] tracking-wider mt-8 active:scale-95 transition-transform">
                                åŒ–ç‚ºå¾®å…‰
                            </button>
                        </div>

                        {/* å‹•ç•«ï¼šå‡èµ·çš„æ˜Ÿå…‰ */}
                        {animatingStars.map(star => (
                            <div key={star.id} className="fixed w-2 h-2 bg-[#FFFDE7] rounded-full z-50 pointer-events-none" style={{left: star.left + '%', top: '70vh', boxShadow: '0 0 15px 5px rgba(255, 253, 231, 0.6)', animation: 'floatUp 3s ease-in forwards', animationDelay: star.delay + 's'}} />
                        ))}

                        {/* ç•«é¢äºŒï¼šæ™šå®‰è¨Šæ¯ */}
                        <div className={`fixed inset-0 flex flex-col items-center justify-center p-5 transition-opacity duration-1000 z-40 ${step === 'success' ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
                            <div className="text-[18px] leading-loose text-center text-[#D3D8D3]">
                                é€™ä¸‰å€‹å¾®å°çš„ç¬é–“ï¼Œ<br/>
                                å·²ç¶“åŒ–ä½œå…‰èŠ’ï¼Œç‚ºä½ çš„æ˜å¤©é‹ªå¥½äº†è·¯ã€‚<br/><br/>
                                è¾›è‹¦äº†ï¼Œæ™šå®‰ã€‚
                            </div>
                            <button onClick={() => setStep('history')} className="mt-10 px-6 py-3 border border-[#8C9C8C] text-[#8C9C8C] rounded-full text-[15px] active:bg-[#8C9C8C] active:text-white transition-colors">
                                å›é¡§æˆ‘çš„æ˜Ÿç©º
                            </button>
                        </div>

                        {/* ç•«é¢ä¸‰ï¼šæ˜Ÿç©ºæ­·å²å›é¡§ */}
                        <div className={`fixed inset-0 pt-16 px-5 transition-opacity duration-1000 z-30 ${step === 'history' ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
                            <div className="text-center text-[16px] text-[#A0AAB5] tracking-wide">
                                ä½ ç´¯ç©äº† {history.length} å¤©çš„å¾®å…‰
                            </div>
                            
                            <div className="relative h-[60vh] mt-8 w-full max-w-md mx-auto">
                                {history.map(item => (
                                    <div key={item.id} onClick={() => setSelectedMemory(item)} className="absolute w-3 h-3 bg-[#FFFDE7] rounded-full cursor-pointer z-10" style={{left: item.x + '%', top: item.y + '%', animation: 'pulseStar ' + item.pulseDuration + 's infinite alternate', boxShadow: '0 0 10px 3px rgba(255, 253, 231, 0.4)'}} />
                                ))}
                            </div>

                            {/* ğŸ‘‡ æ–°å¢çš„è¿”å›é¦–é æŒ‰éˆ• ğŸ‘‡ */}
                            <div className="text-center mt-6">
                                <button 
                                    onClick={() => { setStep('input'); setIsNightMode(false); }} 
                                    className="px-6 py-3 border border-[#8C9C8C] text-[#8C9C8C] rounded-full text-[15px] active:bg-[#8C9C8C] active:text-white transition-colors"
                                >
                                    è¿”å›é¦–é 
                                </button>
                            </div>
                            {/* ğŸ‘† æ–°å¢çš„è¿”å›é¦–é æŒ‰éˆ• ğŸ‘† */}

                            {/* æ­·å²å¡ç‰‡ Modal */}
                            {selectedMemory && (
                                <div className="absolute top-[20%] left-5 right-5 bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl p-6 text-center shadow-lg z-50" style={{ animation: 'fadeIn 0.4s forwards' }}>
                                    <div className="text-[12px] text-[#A0AAB5] mb-4">{selectedMemory.date}</div>
                                    <div className="space-y-3 text-[15px] leading-relaxed text-[#E0E0E0]">
                                        {selectedMemory.entries.map((text, i) => (
                                            <div key={i}>{text}</div>
                                        ))}
                                    </div>
                                    <button onClick={() => setSelectedMemory(null)} className="mt-6 px-5 py-2 border border-[#8C9C8C] text-[#8C9C8C] rounded-full text-[14px]">
                                        é—œé–‰
                                    </button>
                                </div>
                            )}
                        </div>

                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
